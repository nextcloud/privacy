{"version":3,"sources":["webpack:///./src/components/Encryption.vue?0d63","webpack:///src/components/Encryption.vue","webpack:///./src/components/Encryption.vue?f613","webpack:///./src/components/Encryption.vue","webpack:///./node_modules/vue-click-outside/index.js","webpack:///./node_modules/@nextcloud/initial-state/dist/index.js"],"names":["component","_vm","this","_h","$createElement","_c","_self","staticClass","directives","name","rawName","value","isEditing","expression","domProps","_s","label","_v","$is_admin","attrs","on","$event","stopPropagation","preventDefault","openEditFullDiskEncryptionForm","_e","isSavingChanges","Array","isArray","fullDiskEncryptionEnabled","_i","$$a","$$el","target","$$c","checked","$$i","concat","slice","saveFullDiskEncryptionForm","$t","validate","binding","console","warn","isServer","vNode","componentInstance","$isServer","module","exports","bind","el","handler","e","context","elements","path","composedPath","length","unshift","contains","popupItem","i","len","isPopup","__vueClickOutside__","callback","clickHandler","document","documentElement","addEventListener","update","unbind","removeEventListener","Object","defineProperty","loadState","app","key","elem","querySelector","Error","JSON","parse","atob"],"mappings":"iGAAA,I,4NCuDA,ICvD0L,EDuD1L,CACA,kBACA,YACA,YACA,kBAEA,YACA,kBAEA,KATA,WAUA,OACA,6BACA,+BACA,aACA,qBAGA,UACA,MADA,WAEA,wEAEA,kEACA,kGACA,0IACA,+BACA,iEACA,yEAEA,oKACA,0IACA,8BAVA,mEAmBA,QAvCA,WAwCA,0EACA,4EACA,8FACA,mGAEA,SAIA,+BAJA,WAKA,mBAKA,iCAVA,WAWA,mBAOA,2BAlBA,WAkBA,I,EAAA,c,EAAA,mIACA,gEACA,qBAFA,kBAKA,0DALA,uDAOA,oBACA,sEAGA,yDAXA,yBAaA,qBACA,eAdA,2E,6LE/GIA,EAAY,YACd,GHRW,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,IAAI,CAACG,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,OAAQV,EAAIW,UAAWC,WAAW,eAAeC,SAAS,CAAC,UAAYb,EAAIc,GAAGd,EAAIe,UAAUf,EAAIgB,GAAG,KAAMhB,EAAIiB,YAAcjB,EAAIW,UAAWP,EAAG,UAAU,CAACA,EAAG,eAAe,CAACc,MAAM,CAAC,KAAO,eAAeC,GAAG,CAAC,MAAQ,SAASC,GAAyD,OAAjDA,EAAOC,kBAAkBD,EAAOE,iBAAwBtB,EAAIuB,+BAA+BH,QAAa,GAAGpB,EAAIwB,KAAKxB,EAAIgB,GAAG,KAAMhB,EAAa,UAAEI,EAAG,MAAM,CAACG,WAAW,CAAC,CAACC,KAAK,gBAAgBC,QAAQ,kBAAkBC,MAAOV,EAAoC,iCAAEY,WAAW,sCAAsC,CAACR,EAAG,OAAO,CAACA,EAAG,QAAQ,CAACG,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOV,EAA6B,0BAAEY,WAAW,8BAA8BN,YAAY,WAAWY,MAAM,CAAC,GAAK,oCAAoC,SAAWlB,EAAIyB,gBAAgB,KAAO,WAAW,KAAO,qCAAqCZ,SAAS,CAAC,QAAUa,MAAMC,QAAQ3B,EAAI4B,2BAA2B5B,EAAI6B,GAAG7B,EAAI4B,0BAA0B,OAAO,EAAG5B,EAA6B,2BAAGmB,GAAG,CAAC,OAAS,CAAC,SAASC,GAAQ,IAAIU,EAAI9B,EAAI4B,0BAA0BG,EAAKX,EAAOY,OAAOC,IAAIF,EAAKG,QAAuB,GAAGR,MAAMC,QAAQG,GAAK,CAAC,IAAaK,EAAInC,EAAI6B,GAAGC,EAAhB,MAA4BC,EAAKG,QAASC,EAAI,IAAInC,EAAI4B,0BAA0BE,EAAIM,OAAO,CAA3F,QAAwGD,GAAK,IAAInC,EAAI4B,0BAA0BE,EAAIO,MAAM,EAAEF,GAAKC,OAAON,EAAIO,MAAMF,EAAI,UAAWnC,EAAI4B,0BAA0BK,GAAMjC,EAAIsC,+BAA+BtC,EAAIgB,GAAG,KAAKZ,EAAG,QAAQ,CAACc,MAAM,CAAC,IAAM,sCAAsC,CAAClB,EAAIgB,GAAG,aAAahB,EAAIc,GAAGd,EAAIuC,GAAG,UAAW,+CAA+C,kBAAkBvC,EAAIwB,MAAM,KACvuD,IGUpB,EACA,KACA,KACA,MAIa,UAAAzB,E,2BClBf,SAASyC,EAASC,GAChB,MAA6B,mBAAlBA,EAAQ/B,QACjBgC,QAAQC,KAAK,2CAA4CF,EAAQ7B,WAAY,uBACtE,GA0BX,SAASgC,EAASC,GAChB,YAA0C,IAA5BA,EAAMC,mBAAqCD,EAAMC,kBAAkBC,UAGzEC,EAAOC,QAAU,CACzBC,KAAM,SAAUC,EAAIV,EAASI,GAC3B,IAAKL,EAASC,GAAU,OAGxB,SAASW,EAAQC,GACf,GAAKR,EAAMS,QAAX,CAGA,IAAIC,EAAWF,EAAEG,MAASH,EAAEI,cAAgBJ,EAAEI,eAC9CF,GAAYA,EAASG,OAAS,GAAKH,EAASI,QAAQN,EAAErB,QAElDmB,EAAGS,SAASP,EAAErB,SApCxB,SAAiB6B,EAAWN,GAC1B,IAAKM,IAAcN,EACjB,OAAO,EAET,IAAK,IAAIO,EAAI,EAAGC,EAAMR,EAASG,OAAQI,EAAIC,EAAKD,IAC9C,IACE,GAAID,EAAUD,SAASL,EAASO,IAC9B,OAAO,EAET,GAAIP,EAASO,GAAGF,SAASC,GACvB,OAAO,EAET,MAAMR,GACN,OAAO,EAIX,OAAO,EAmB0BW,CAAQnB,EAAMS,QAAQO,UAAWN,IAE9DJ,EAAGc,oBAAoBC,SAASb,IAIlCF,EAAGc,oBAAsB,CACvBb,QAASA,EACTc,SAAUzB,EAAQ/B,OAEpB,MAAMyD,EAAe,iBAAkBC,SAASC,gBAAkB,aAAe,SAChFzB,EAASC,IAAUuB,SAASE,iBAAiBH,EAAcf,IAG9DmB,OAAQ,SAAUpB,EAAIV,GAChBD,EAASC,KAAUU,EAAGc,oBAAoBC,SAAWzB,EAAQ/B,QAGnE8D,OAAQ,SAAUrB,EAAIV,EAASI,GAE7B,MAAMsB,EAAe,iBAAkBC,SAASC,gBAAkB,aAAe,SAChFzB,EAASC,IAAUM,EAAGc,qBAAuBG,SAASK,oBAAoBN,EAAchB,EAAGc,oBAAoBb,gBACzGD,EAAGc,uB,iCCjEd,EAAQ,KAERS,OAAOC,eAAe1B,EAAS,aAAc,CAC3CvC,OAAO,IAETuC,EAAQ2B,UAOR,SAAmBC,EAAKC,GACtB,IAAIC,EAAOX,SAASY,cAAc,kBAAkB5C,OAAOyC,EAAK,KAAKzC,OAAO0C,IAE5E,GAAa,OAATC,EACF,MAAM,IAAIE,MAAM,gCAAgC7C,OAAO0C,EAAK,QAAQ1C,OAAOyC,IAG7E,IACE,OAAOK,KAAKC,MAAMC,KAAKL,EAAKrE,QAC5B,MAAO2C,GACP,MAAM,IAAI4B,MAAM,iCAAiC7C,OAAO0C,EAAK,QAAQ1C,OAAOyC","file":"chunks/6-cb3756be5d83e6808ba0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"who-has-access\"},[_c('p',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isEditing),expression:\"!isEditing\"}],domProps:{\"innerHTML\":_vm._s(_vm.label)}}),_vm._v(\" \"),(_vm.$is_admin && !_vm.isEditing)?_c('Actions',[_c('ActionButton',{attrs:{\"icon\":\"icon-rename\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.openEditFullDiskEncryptionForm($event)}}})],1):_vm._e(),_vm._v(\" \"),(_vm.isEditing)?_c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.cancelEditFullDiskEncryptionForm),expression:\"cancelEditFullDiskEncryptionForm\"}]},[_c('form',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.fullDiskEncryptionEnabled),expression:\"fullDiskEncryptionEnabled\"}],staticClass:\"checkbox\",attrs:{\"id\":\"fullDiskEncryptionEnabledCheckbox\",\"disabled\":_vm.isSavingChanges,\"type\":\"checkbox\",\"name\":\"fullDiskEncryptionEnabledCheckbox\"},domProps:{\"checked\":Array.isArray(_vm.fullDiskEncryptionEnabled)?_vm._i(_vm.fullDiskEncryptionEnabled,null)>-1:(_vm.fullDiskEncryptionEnabled)},on:{\"change\":[function($event){var $$a=_vm.fullDiskEncryptionEnabled,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.fullDiskEncryptionEnabled=$$a.concat([$$v]))}else{$$i>-1&&(_vm.fullDiskEncryptionEnabled=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.fullDiskEncryptionEnabled=$$c}},_vm.saveFullDiskEncryptionForm]}}),_vm._v(\" \"),_c('label',{attrs:{\"for\":\"fullDiskEncryptionEnabledCheckbox\"}},[_vm._v(\"\\n\\t\\t\\t\\t\"+_vm._s(_vm.$t('privacy', 'This server is using full-disk-encryption.'))+\"\\n\\t\\t\\t\")])])]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\n  - @copyright Copyright (c) 2019 Georg Ehrke <oc.list@georgehrke.com>\n  - @author Georg Ehrke <oc.list@georgehrke.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<div class=\"who-has-access\">\n\t\t<!-- eslint-disable-next-line vue/no-v-html -->\n\t\t<p v-show=\"!isEditing\" v-html=\"label\" />\n\t\t<Actions v-if=\"$is_admin && !isEditing\">\n\t\t\t<ActionButton icon=\"icon-rename\" @click.stop.prevent=\"openEditFullDiskEncryptionForm\" />\n\t\t</Actions>\n\t\t<div v-if=\"isEditing\" v-click-outside=\"cancelEditFullDiskEncryptionForm\">\n\t\t\t<form>\n\t\t\t\t<input id=\"fullDiskEncryptionEnabledCheckbox\"\n\t\t\t\t\tv-model=\"fullDiskEncryptionEnabled\"\n\t\t\t\t\t:disabled=\"isSavingChanges\"\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tname=\"fullDiskEncryptionEnabledCheckbox\"\n\t\t\t\t\tclass=\"checkbox\"\n\t\t\t\t\t@change=\"saveFullDiskEncryptionForm\">\n\t\t\t\t<label for=\"fullDiskEncryptionEnabledCheckbox\">\n\t\t\t\t\t{{ $t('privacy', 'This server is using full-disk-encryption.') }}\n\t\t\t\t</label>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport ClickOutside from 'vue-click-outside'\n\nimport HttpClient from '@nextcloud/axios'\nimport { generateUrl } from '@nextcloud/router'\nimport Actions from '@nextcloud/vue/dist/Components/Actions'\nimport ActionButton from '@nextcloud/vue/dist/Components/ActionButton'\nimport { loadState } from '@nextcloud/initial-state'\nimport { showError } from '@nextcloud/dialogs'\n\nexport default {\n\tname: 'Encryption',\n\tcomponents: {\n\t\tActions,\n\t\tActionButton,\n\t},\n\tdirectives: {\n\t\tClickOutside,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tfullDiskEncryptionEnabled: false,\n\t\t\tserverSideEncryptionEnabled: false,\n\t\t\tisEditing: false,\n\t\t\tisSavingChanges: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\tlabel() {\n\t\t\tif (!this.serverSideEncryptionEnabled && !this.fullDiskEncryptionEnabled) {\n\t\t\t\treturn this.$t('privacy', 'Your files are not protected by encryption.')\n\t\t\t} else if (this.serverSideEncryptionEnabled && !this.fullDiskEncryptionEnabled) {\n\t\t\t\treturn this.$t('privacy', 'Your files are encrypted with {linkopen}server-side-encryption ↗{linkclose}.')\n\t\t\t\t\t.replace('{linkopen}', '<a href=\"https://nextcloud.com/blog/encryption-in-nextcloud/\" target=\"_blank\" title=\"\" rel=\"noreferrer noopener\">')\n\t\t\t\t\t.replace('{linkclose}', '</a>')\n\t\t\t} else if (!this.serverSideEncryptionEnabled && this.fullDiskEncryptionEnabled) {\n\t\t\t\treturn this.$t('privacy', 'This server is protected with full-disk-encryption.')\n\t\t\t} else {\n\t\t\t\treturn this.$t('privacy', 'Your files are encrypted with {linkopen}server-side-encryption ↗{linkclose}. Additionally, this server is protected with full-disk-encryption.')\n\t\t\t\t\t.replace('{linkopen}', '<a href=\"https://nextcloud.com/blog/encryption-in-nextcloud/\" target=\"_blank\" title=\"\" rel=\"noreferrer noopener\">')\n\t\t\t\t\t.replace('{linkclose}', '</a>')\n\t\t\t}\n\t\t},\n\t},\n\t/**\n\t * This function is called on mount of the Vue component\n\t * It checks if full-disk-encryption or server-side-encryption\n\t * are enabled\n\t */\n\tmounted() {\n\t\tconsole.debug(loadState('privacy', 'fullDiskEncryptionEnabled'))\n\t\tconsole.debug(loadState('privacy', 'serverSideEncryptionEnabled'))\n\t\tthis.fullDiskEncryptionEnabled = loadState('privacy', 'fullDiskEncryptionEnabled') === 1\n\t\tthis.serverSideEncryptionEnabled = loadState('privacy', 'serverSideEncryptionEnabled') === 1\n\t},\n\tmethods: {\n\t\t/**\n\t\t * Opens the form to edit the full-disk-encryption-state\n\t\t */\n\t\topenEditFullDiskEncryptionForm() {\n\t\t\tthis.isEditing = true\n\t\t},\n\t\t/**\n\t\t * Closes the form to edit the full-disk-encryption-state\n\t\t */\n\t\tcancelEditFullDiskEncryptionForm() {\n\t\t\tthis.isEditing = false\n\t\t},\n\t\t/**\n\t\t * Saves the new full-disk-encryption-state\n\t\t *\n\t\t * @returns {Promise<void>}\n\t\t */\n\t\tasync saveFullDiskEncryptionForm() {\n\t\t\tconst url = generateUrl('/apps/privacy/api/fullDiskEncryption')\n\t\t\tthis.isSavingChanges = true\n\n\t\t\ttry {\n\t\t\t\tawait HttpClient.post(url, { enabled: this.fullDiskEncryptionEnabled ? '1' : '0' })\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(error)\n\t\t\t\tshowError('Error saving new state of full-disk-encryption')\n\n\t\t\t\t// Reset state\n\t\t\t\tthis.fullDiskEncryptionEnabled = !this.fullDiskEncryptionEnabled\n\t\t\t} finally {\n\t\t\t\tthis.isSavingChanges = false\n\t\t\t\tthis.isEditing = false\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Encryption.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Encryption.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Encryption.vue?vue&type=template&id=04c90f45&\"\nimport script from \"./Encryption.vue?vue&type=script&lang=js&\"\nexport * from \"./Encryption.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","function validate(binding) {\n  if (typeof binding.value !== 'function') {\n    console.warn('[Vue-click-outside:] provided expression', binding.expression, 'is not a function.')\n    return false\n  }\n\n  return true\n}\n\nfunction isPopup(popupItem, elements) {\n  if (!popupItem || !elements)\n    return false\n\n  for (var i = 0, len = elements.length; i < len; i++) {\n    try {\n      if (popupItem.contains(elements[i])) {\n        return true\n      }\n      if (elements[i].contains(popupItem)) {\n        return false\n      }\n    } catch(e) {\n      return false\n    }\n  }\n\n  return false\n}\n\nfunction isServer(vNode) {\n  return typeof vNode.componentInstance !== 'undefined' && vNode.componentInstance.$isServer\n}\n\nexports = module.exports = {\n  bind: function (el, binding, vNode) {\n    if (!validate(binding)) return\n\n    // Define Handler and cache it on the element\n    function handler(e) {\n      if (!vNode.context) return\n\n      // some components may have related popup item, on which we shall prevent the click outside event handler.\n      var elements = e.path || (e.composedPath && e.composedPath())\n      elements && elements.length > 0 && elements.unshift(e.target)\n\n      if (el.contains(e.target) || isPopup(vNode.context.popupItem, elements)) return\n\n      el.__vueClickOutside__.callback(e)\n    }\n\n    // add Event Listeners\n    el.__vueClickOutside__ = {\n      handler: handler,\n      callback: binding.value\n    }\n    const clickHandler = 'ontouchstart' in document.documentElement ? 'touchstart' : 'click';\n    !isServer(vNode) && document.addEventListener(clickHandler, handler)\n  },\n\n  update: function (el, binding) {\n    if (validate(binding)) el.__vueClickOutside__.callback = binding.value\n  },\n\n  unbind: function (el, binding, vNode) {\n    // Remove Event Listeners\n    const clickHandler = 'ontouchstart' in document.documentElement ? 'touchstart' : 'click';\n    !isServer(vNode) && el.__vueClickOutside__ && document.removeEventListener(clickHandler, el.__vueClickOutside__.handler)\n    delete el.__vueClickOutside__\n  }\n}\n","\"use strict\";\n\nrequire(\"core-js/modules/es.array.concat\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.loadState = loadState;\n\n/**\n * @param app app ID, e.g. \"mail\"\n * @param key name of the property\n * @throws if the key can't be found\n */\nfunction loadState(app, key) {\n  var elem = document.querySelector(\"#initial-state-\".concat(app, \"-\").concat(key));\n\n  if (elem === null) {\n    throw new Error(\"Could not find initial state \".concat(key, \" of \").concat(app));\n  }\n\n  try {\n    return JSON.parse(atob(elem.value));\n  } catch (e) {\n    throw new Error(\"Could not parse initial state \".concat(key, \" of \").concat(app));\n  }\n}\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}